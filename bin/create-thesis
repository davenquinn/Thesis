#!/usr/bin/env zsh

# https://stmorse.github.io/journal/Thesis-writeup.html

# First we link to the text that comprises each standalone
# chapter. (Note: we assume that the bibliography in each chapter
# is complete and don't try to add to it ourselves)

PROJECTS=$HOME/Development/
SYRTIS=$PROJECTS/Syrtis/versioned/Papers

cd $PROJECT_DIR

build="build"
mkdir -p build

source paper-components/defs.zsh

texfile=build/main.tex

preamble="$build/preamble.tex"
cp thesis-template/* build
cp main.tex $texfile
cat "paper-components/defs/preamble-thesis"/*.tex > $preamble
cat chapters/04-statistics/text/math-defs.tex >> $preamble

bin/create-sections

cp $BIBTEX_LIBRARY build/references.bib
run-latex-draft $texfile build/Daven-Quinn-thesis-draft.pdf

for chapter in chapters/*; do
  name=${chapter:t}
  bibtex build/$name/body.aux
done

for chapter in build/sections/*.aux; do
  bibtex $chapter
done

run-latex $texfile build/Daven-Quinn-thesis-draft.pdf

